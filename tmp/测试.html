<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>文本限制测试页面</title>
  <style>
    /* 禁止所有元素的文本选择（兼容主流浏览器） */
    * {
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }

    /* 特殊样式：模拟动态内容加载后的限制 */
    .dynamic-content {
      color: red;
      font-weight: bold;
    }
  </style>
  <script>
    // 1. 禁止复制事件（触发弹窗提示）
    document.addEventListener('copy', function(e) {
      e.preventDefault();
      alert("禁止复制！");
    });

    // 2. 禁止选择开始事件（兼容旧版浏览器）
    document.addEventListener('selectstart', function(e) {
      e.preventDefault();
    });

    // 3. 禁止右键菜单事件（防止通过右键复制）
    document.addEventListener('contextmenu', function(e) {
      e.preventDefault();
      alert("禁止右键菜单！");
    });

    // 4. 禁止拖拽事件（防止拖拽复制文本）
    document.addEventListener('dragstart', function(e) {
      e.preventDefault();
    });

    // 5. 动态内容适配：模拟 AJAX 加载后的内容限制
    window.onload = function() {
      const container = document.getElementById('content');
      const newParagraph = document.createElement('p');
      newParagraph.className = 'dynamic-content';
      newParagraph.textContent = '动态加载的内容也无法选中或复制。';
      container.appendChild(newParagraph);

      // 对动态内容重新应用限制
      applyRestrictions(newParagraph);
    };

    // 6. 通用限制函数：为指定元素绑定事件
    function applyRestrictions(element) {
      element.addEventListener('copy', function(e) {
        e.preventDefault();
        alert("动态内容禁止复制！");
      });

      element.addEventListener('selectstart', function(e) {
        e.preventDefault();
      });
    }

    // 7. MutationObserver 监控 DOM 变化（可选）
    const observer = new MutationObserver((mutations) => {
      mutations.forEach(mutation => {
        mutation.addedNodes.forEach(node => {
          if (node.nodeType === 1 && node.matches('p')) {
            applyRestrictions(node);
          }
        });
      });
    });

    observer.observe(document.body, { childList: true, subtree: true });
  </script>
</head>
<body>
  <h1>文本限制测试页面</h1>
  <div id="content">
    <p>这段文字无法选中或复制。</p>
  </div>
</body>
</html>
